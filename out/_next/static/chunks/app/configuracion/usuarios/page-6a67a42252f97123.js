(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6906],{58123:function(e,r,a){Promise.resolve().then(a.bind(a,22836))},22836:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return F}});var s=a(9268),t=a(96230),l=a(90362),o=a(98945),n=a(92951),i=a(52641),c=a(83206),u=a(70509),d=a(76234),h=a(53235),m=a(50946),x=a(81145),f=a(15834),g=a(47434),v=a(4660),j=a(86006),p=a(5710),w=a(96936),y=a(68919),Z=a(4802),b=a(99329),C=function(){return(C=Object.assign||function(e){for(var r,a=1,s=arguments.length;a<s;a++)for(var t in r=arguments[a])Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}).apply(this,arguments)},k=j.forwardRef(function(e,r){var a=C(C({},j.useContext(b.s)),e);return j.createElement("svg",C({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:r},a),j.createElement("path",{d:"M11.5 12H6.6a.6.6 0 00-.6.6v6.8a.6.6 0 00.6.6h10.8a.6.6 0 00.6-.6v-.9M16 12V8c0-1.333-.8-4-4-4-.747 0-1.363.145-1.869.385M16 12h1.4a.6.6 0 01.6.6v.4M8 8v4M3 3l18 18",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))}),E=a(96407);let P=e=>{let{handleCancel:r}=e,a=(0,v.I)(),t=(0,i.useSelector)(e=>e.crud.data),{data:l}=(0,E.Ym)(null),o=(0,j.useMemo)(()=>null==l?void 0:l.data,[l]),[n]=c.Z.useForm(),[b,C]=(0,j.useState)(p.ds),[P,{isLoading:T,isError:q,error:I,isSuccess:N,data:O}]=(0,w.ny)(),[F,{isLoading:_,isError:L,error:M,isSuccess:S,data:D}]=(0,w.kD)();(0,j.useEffect)(()=>{t&&(C({...t,contrasenia:t.contrasenia,cod_rol:t.rol.cod_rol}),n.setFieldsValue({...t,contrasenia:t.contrasenia,cod_rol:t.rol.cod_rol}))},[t]);let U=(e,r)=>{if(!r&&e.target){let{name:r,value:a}=e.target;n.setFieldsValue({[r]:a||""}),C(e=>({...e,[r]:a||""}))}else n.setFieldsValue({[r]:e||""}),C(a=>({...a,[r]:e||""}))},[R,V]=(0,j.useState)(!0),A=()=>{V(!R)};(0,j.useEffect)(()=>{t&&(R?(n.setFieldsValue({password:t.contrasenia}),C(e=>({...e,password:t.contrasenia}))):(n.setFieldsValue({password:""}),C(e=>({...e,password:""}))))},[R]);let Q=async e=>{try{t?(R?delete e.password:e.password=b.password,await F({user:e,id:t.cod_usuario})):await P(e)}catch(e){y.toast.error(e)}};return(0,j.useEffect)(()=>{if(N&&(y.toast.success(null==O?void 0:O.msg),r()),q){var e;y.toast.error(null===(e=I.data)||void 0===e?void 0:e.msg)}},[N,q]),(0,j.useEffect)(()=>{if(S&&(y.toast.success(null==D?void 0:D.msg),r()),L){var e;y.toast.error(null===(e=M.data)||void 0===e?void 0:e.msg)}},[S,L]),(0,s.jsx)(c.Z,{form:n,layout:"vertical",requiredMark:!0,onFinish:Q,autoComplete:"off",scrollToFirstError:!0,children:(0,s.jsxs)(u.Z,{gutter:[16,16],children:[(0,s.jsx)(d.Z,{xs:24,md:24,lg:12,children:(0,s.jsx)(c.Z.Item,{name:"nombre",label:(0,s.jsx)(g.L,{text:"Nombre"}),hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese el nombre"}],children:(0,s.jsx)(h.Z,{name:"nombre",placeholder:"Ingrese el nombre",value:b.nombre,onChange:U,allowClear:!0})})}),(0,s.jsx)(d.Z,{xs:24,md:12,lg:12,children:(0,s.jsx)(c.Z.Item,{name:"dni",value:b.dni,label:(0,s.jsx)(g.L,{text:"DNI"}),hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese el DNI"},{validator:(e,r)=>r&&8!==r.toString().length?Promise.reject(Error("El campo debe tener 8 d\xedgitos")):Promise.resolve()}],children:(0,s.jsx)(h.Z,{placeholder:"Ingrese el DNI",name:"dni",maxLength:8,value:b.dni,onChange:U,allowClear:!0})})}),(0,s.jsx)(d.Z,{xs:24,md:12,lg:12,children:(0,s.jsx)(c.Z.Item,{name:"celular",value:b.celular,label:(0,s.jsx)(g.L,{text:"Celular"}),hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese el celular"}],children:(0,s.jsx)(h.Z,{placeholder:"Ingrese el celular",name:"celular",value:b.celular,onChange:U,allowClear:!0})})}),(0,s.jsx)(d.Z,{xs:24,md:12,lg:12,children:(0,s.jsx)(c.Z.Item,{name:"oficina",value:b.oficina,label:(0,s.jsx)(g.L,{text:"Oficina"}),hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese la oficina"}],children:(0,s.jsx)(h.Z,{placeholder:"Ingrese la oficina",name:"oficina",value:b.oficina,onChange:U,allowClear:!0})})}),(0,s.jsx)(d.Z,{xs:24,md:12,lg:12,children:(0,s.jsx)(c.Z.Item,{name:"correo",value:b.correo,label:(0,s.jsx)(g.L,{text:"Correo"}),hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese el correo"},{type:"email",message:"\xa1No es un correo electr\xf3nico v\xe1lido!"}],children:(0,s.jsx)(h.Z,{type:"email",placeholder:"Ingrese el correo",name:"correo",value:b.correo,onChange:U,allowClear:!0})})}),(0,s.jsx)(d.Z,{xs:24,md:12,lg:12,children:(0,s.jsx)(c.Z.Item,{name:"password",value:b.password,label:(0,s.jsx)(g.L,{text:"Contrase\xf1a"}),hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese una constrase\xf1a"}],children:t&&R?(0,s.jsx)(m.ZP,{icon:(0,s.jsx)(Z.Z,{}),onClick:A,className:"flex flex-row justify-center items-center border-green-500 text-green-500 hover:bg-green-500 hover:text-white",children:"Cambiar contrase\xf1a"}):(0,s.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,s.jsx)(h.Z.Password,{placeholder:"Ingrese la contrase\xf1a",name:"password",value:b.password,onChange:U,allowClear:!0}),t&&(0,s.jsx)(m.ZP,{icon:(0,s.jsx)(k,{}),className:"flex flex-row justify-center items-center border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:A,children:"Cancelar"})]})})}),(0,s.jsx)(d.Z,{span:24,children:(0,s.jsx)(c.Z.Item,{name:"cod_rol",value:b.rol,label:(0,s.jsx)(g.L,{text:"   Rol"}),rules:[{required:!0,message:"Por favor elija un rol."}],children:(0,s.jsx)(x.ZP.Group,{name:"cod_rol",value:b.cod_rol,initialValues:b.cod_rol,children:(0,s.jsx)(f.Z,{direction:"vertical",children:null==o?void 0:o.map(e=>(0,s.jsx)(x.ZP,{value:e.cod_rol,children:e.rol},e.cod_rol))})})})}),(0,s.jsx)(d.Z,{span:24,children:(0,s.jsx)(c.Z.Item,{children:(0,s.jsxs)(u.Z,{gutter:[16,16],justify:"end",children:[(0,s.jsx)(d.Z,{xs:24,md:12,lg:4,justify:"end",order:a?2:1,children:(0,s.jsx)(m.ZP,{onClick:r,className:"w-full",children:"Cancelar"},"back")}),(0,s.jsx)(d.Z,{xs:24,md:12,lg:6,order:a?1:2,children:(0,s.jsx)(m.ZP,{type:"primary",loading:t?_:T,htmlType:"submit",className:"w-full",children:"Guardar usuario"})})]})})})]})})},T=e=>{let{isModalOpen:r,handleCancel:a}=e,c=(0,i.useDispatch)(),u=(0,i.useSelector)(e=>e.crud.data),d=()=>{c((0,t.qD)()),a()};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(l.Z,{title:(0,s.jsx)(o.Z.Title,{level:3,className:"text-center text-text-title",children:u?"Editar Usuario":"Nuevo Usuario"}),style:{top:20},width:1e3,open:r,onCancel:d,footer:null,children:[(0,s.jsx)(n.Z,{className:"mt-0"}),(0,s.jsx)(P,{handleCancel:d})]})})};var q=a(91608);let I=e=>{let{columns:r,data:a}=e;return(0,s.jsx)(q.Z,{columns:r,dataSource:a,rowKey:e=>e.cod_usuario,scroll:{x:"max-content",y:"max-content"}})};var N=a(24294),O=a(88334);function F(){let e=(0,i.useDispatch)(),{data:r}=(0,w.zQ)(null),[a,{isError:l,error:o,isSuccess:c,data:h}]=(0,w.I1)(),x=r=>{e((0,t.qT)({data:r})),p()},g=async e=>{try{await a(e)}catch(e){y.toast.error(e)}};(0,j.useEffect)(()=>{if(l){var e;y.toast.error(null===(e=o.data)||void 0===e?void 0:e.msg)}c&&y.toast.success(null==h?void 0:h.msg)},[l,c]);let{isModalOpen:v,handleOpen:p,handleCancel:Z}=(0,O.d)(),b=(0,N.i)(x,g),C=(0,j.useMemo)(()=>null==r?void 0:r.data,[r]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(f.Z,{direction:"vertical",className:"w-full",size:"large",children:[(0,s.jsx)(u.Z,{gutter:16,align:"middle",justify:"end",children:(0,s.jsx)(d.Z,{xs:24,md:6,lg:6,children:(0,s.jsx)(m.ZP,{type:"primary",onClick:p,className:"w-full",children:"Nuevo usuario"})})}),(0,s.jsx)(n.Z,{className:"m-0"}),(0,s.jsx)("div",{children:(0,s.jsx)(I,{columns:b,data:C})})]}),v&&(0,s.jsx)(T,{isModalOpen:v,handleCancel:Z})]})}},96407:function(e,r,a){"use strict";a.d(r,{Lh:function(){return o},Ym:function(){return l},gK:function(){return n},h0:function(){return t},rz:function(){return i}});var s=a(32895);let t=(0,s.createApi)({reducerPath:"rolesApi",baseQuery:(0,s.fetchBaseQuery)({baseUrl:"http://3.86.194.103/api/v1/"}),refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,tagTypes:["roles"],endpoints:e=>({getRoles:e.query({query:()=>({url:"rol",method:"GET"}),providesTags:["roles"]}),createRole:e.mutation({query:e=>({url:"rol",method:"POST",body:e}),invalidatesTags:["roles"]}),updateRole:e.mutation({query:e=>{let{role:r,id:a}=e;return{url:"rol/".concat(a),method:"PUT",body:r}},invalidatesTags:["roles"]}),deleteRole:e.mutation({query:e=>({url:"rol/".concat(e),method:"DELETE"}),invalidatesTags:["roles"]})})}),{useGetRolesQuery:l,useCreateRoleMutation:o,useUpdateRoleMutation:n,useDeleteRoleMutation:i}=t},96936:function(e,r,a){"use strict";a.d(r,{I1:function(){return i},g8:function(){return t},kD:function(){return n},ny:function(){return o},zQ:function(){return l}});var s=a(32895);let t=(0,s.createApi)({reducerPath:"usersApi",baseQuery:(0,s.fetchBaseQuery)({baseUrl:"http://3.86.194.103/api/v1/"}),refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,tagTypes:["users"],endpoints:e=>({getUsers:e.query({query:()=>({url:"usuario",method:"GET"}),providesTags:["users"]}),createUser:e.mutation({query:e=>({url:"usuario",method:"POST",body:e}),invalidatesTags:["users"]}),updateUser:e.mutation({query:e=>{let{user:r,id:a}=e;return{url:"usuario/".concat(a),method:"PUT",body:r}},invalidatesTags:["users"]}),deleteUser:e.mutation({query:e=>({url:"usuario/".concat(e),method:"DELETE"}),invalidatesTags:["users"]})})}),{useGetUsersQuery:l,useCreateUserMutation:o,useUpdateUserMutation:n,useDeleteUserMutation:i}=t},4802:function(e,r,a){"use strict";var s=a(86006),t=a(99329),l=function(){return(l=Object.assign||function(e){for(var r,a=1,s=arguments.length;a<s;a++)for(var t in r=arguments[a])Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}).apply(this,arguments)},o=s.forwardRef(function(e,r){var a=l(l({},s.useContext(t.s)),e);return s.createElement("svg",l({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:r},a),s.createElement("path",{d:"M16 12h1.4a.6.6 0 01.6.6v6.8a.6.6 0 01-.6.6H6.6a.6.6 0 01-.6-.6v-6.8a.6.6 0 01.6-.6H8m8 0V8c0-1.333-.8-4-4-4S8 6.667 8 8v4m8 0H8",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))});r.Z=o}},function(e){e.O(0,[8779,4790,8945,2641,803,4389,545,4176,4059,2229,3750,1452,1728,3206,4425,638,5243,3933,9833,2005,4294,2667,8139,1744],function(){return e(e.s=58123)}),_N_E=e.O()}]);
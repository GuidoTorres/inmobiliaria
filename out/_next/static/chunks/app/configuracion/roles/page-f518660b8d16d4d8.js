(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2377],{47685:function(e,r,t){Promise.resolve().then(t.bind(t,41248))},41248:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return q}});var s=t(9268),o=t(24294),n=t(88334),l=t(96230),a=t(15834),i=t(86006),c=t(52641),u=t(91608),d=t(42292),m=t(98945),h=t(42724),p=t(743),f=t(39558),x=t(66625);let g=e=>{let{columns:r,data:t,loading:o}=e;return(0,s.jsx)(u.Z,{columns:r,dataSource:t,loading:o,rowKey:e=>e.cod_rol,pagination:!1,scroll:{x:"max-content",y:"max-content"},expandable:{expandedRowRender:e=>e&&(0,s.jsx)(a.Z,{direction:"vertical",className:"w-full",size:"middle",children:(0,s.jsx)(d.Z,{bordered:!1,size:"large",items:e.permisos.map((e,r)=>({key:r,label:(0,s.jsx)(m.Z.Title,{level:5,className:"capitalize",children:e.categoria}),children:(0,s.jsx)(h.Z,{itemLayout:"horizontal",dataSource:e.permisos_categoria,rowKey:e=>e.cod_permiso,renderItem:e=>(0,s.jsx)(h.Z.Item,{children:(0,s.jsx)(h.Z.Item.Meta,{avatar:(0,s.jsx)(p.Z,{}),title:e.permiso,description:e.descripcion})})})}))})}),expandIcon:e=>{let{expanded:r,onExpand:t,record:o}=e;return r?(0,s.jsx)(f.Z,{onClick:e=>t(o,e)}):(0,s.jsx)(x.Z,{onClick:e=>t(o,e)})}}})};var v=t(90362),j=t(92951),y=t(5710),Z=t(4660),b=t(83206),w=t(70509),C=t(76234),E=t(53235),k=t(50946),O=t(47434),_=t(35200),T=t(51483);let R=e=>{let{selectPermissions:r,permisos:t}=e,{data:o}=(0,T.S)(null),n=(0,i.useMemo)(()=>null==o?void 0:o.permisos,[o]);return(0,s.jsx)(_.Z.Group,{onChange:r,value:t,children:(0,s.jsx)(w.Z,{gutter:[16,16],children:null==n?void 0:n.map((e,r)=>{var t;return(0,s.jsx)(C.Z,{xs:24,md:12,lg:8,children:(0,s.jsx)(b.Z.Item,{name:e.cod_categoria,label:(0,s.jsx)(O.L,{text:e.categoria}),children:(0,s.jsx)(a.Z,{direction:"vertical",children:null===(t=e.permisos_categoria)||void 0===t?void 0:t.map(e=>(0,s.jsx)(_.Z,{value:e.cod_permiso,children:e.permiso},e.cod_permiso))})},r)},r)})})})};var F=t(96407),L=t(68919);let N=e=>{let{handleCancel:r}=e,t=(0,Z.I)(),o=(0,c.useSelector)(e=>e.crud.data),[n,{isLoading:l,isError:a,error:u,isSuccess:d,data:m}]=(0,F.Lh)(),[h,{isLoading:p,isError:f,error:x,isSuccess:g,data:v}]=(0,F.gK)(),[j]=b.Z.useForm(),[_,T]=(0,i.useState)(y.jy);(0,i.useEffect)(()=>{if(o){let e=o.permisos.map(e=>e.permisos_categoria.map(e=>e.cod_permiso)).flat();T({...o,nombre:o.rol,permisos:e}),j.setFieldsValue({...o,nombre:o.rol,permisos:e})}},[o]);let N=(e,r)=>{if(!r&&e.target){let{name:r,value:t}=e.target;j.setFieldsValue({[r]:t||""}),T(e=>({...e,[r]:t||""}))}else j.setFieldsValue({[r]:e||""}),T(t=>({...t,[r]:e||""}))},P=e=>{j.setFieldsValue({permisos:e||[]}),T(r=>({...r,permisos:e||[]}))},q=async()=>{try{let e={rol:_.nombre,cod_permiso:_.permisos};o?await h({role:e,id:o.cod_rol}):await n(e)}catch(e){L.toast.error(e)}};return(0,i.useEffect)(()=>{if(d&&(L.toast.success(null==m?void 0:m.msg),r()),a){var e;L.toast.error(null===(e=u.data)||void 0===e?void 0:e.msg)}},[d,a]),(0,i.useEffect)(()=>{if(g&&(L.toast.success(null==v?void 0:v.msg),r()),f){var e;L.toast.error(null===(e=x.data)||void 0===e?void 0:e.msg)}},[g,f]),(0,s.jsx)(b.Z,{form:j,layout:"vertical",requiredMark:!0,onFinish:q,initialValues:_,autoComplete:"off",scrollToFirstError:!0,children:(0,s.jsxs)(w.Z,{gutter:[16,16],children:[(0,s.jsx)(C.Z,{span:24,children:(0,s.jsx)(b.Z.Item,{label:(0,s.jsx)(O.L,{text:"   Nombre del Rol"}),name:"nombre",value:_.nombre,rules:[{required:!0,message:"Por favor ingrese un nombre"}],hasFeedback:!0,children:(0,s.jsx)(E.Z,{name:"nombre",value:_.nombre,placeholder:"Ingrese un nombre del rol",onChange:N,allowClear:!0})})}),(0,s.jsx)(C.Z,{span:24,children:(0,s.jsx)(R,{selectPermissions:P,permisos:_.permisos})}),(0,s.jsx)(C.Z,{span:24,children:(0,s.jsx)(b.Z.Item,{children:(0,s.jsxs)(w.Z,{gutter:[16,16],justify:"end",children:[(0,s.jsx)(C.Z,{xs:24,md:12,lg:4,justify:"end",order:t?2:1,children:(0,s.jsx)(k.ZP,{onClick:r,className:"w-full",children:"Cancelar"},"back")}),(0,s.jsx)(C.Z,{xs:24,md:12,lg:6,order:t?1:2,children:(0,s.jsx)(k.ZP,{type:"primary",loading:o?p:l,htmlType:"submit",className:"w-full",children:"Guardar cliente"})})]})})})]})})},P=e=>{let{isModalOpen:r,handleCancel:t}=e,o=(0,c.useDispatch)(),n=(0,c.useSelector)(e=>e.crud.data),a=()=>{o((0,l.qD)()),t()};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(v.Z,{title:(0,s.jsx)(m.Z.Title,{level:3,className:"text-center text-text-title",children:n?"Editar Rol":"Nuevo Rol"}),style:{top:20},width:1e3,open:r,onCancel:a,footer:null,children:[(0,s.jsx)(j.Z,{className:"mt-0"}),(0,s.jsx)(N,{handleCancel:a})]})})};function q(){let e=(0,c.useDispatch)(),{data:r,isLoading:t}=(0,F.Ym)(null),[u,{isError:d,error:m,isSuccess:h,data:p}]=(0,F.rz)(),f=r=>{e((0,l.qT)({data:r})),j()},x=async e=>{try{await u(e)}catch(e){L.toast.error(e)}};(0,i.useEffect)(()=>{if(h&&L.toast.success(null==p?void 0:p.msg),d){var e;L.toast.error(null===(e=m.data)||void 0===e?void 0:e.msg)}},[h,d]);let{isModalOpen:v,handleOpen:j,handleCancel:y}=(0,n.d)(),Z=(0,o.t1)(f,x),b=(0,i.useMemo)(()=>null==r?void 0:r.data,[r]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{direction:"vertical",className:"w-full",size:"large",children:(0,s.jsx)("div",{children:(0,s.jsx)(g,{columns:Z,data:b,loading:t})})}),v&&(0,s.jsx)(P,{isModalOpen:v,handleCancel:y})]})}},51483:function(e,r,t){"use strict";t.d(r,{J:function(){return o},S:function(){return n}});var s=t(32895);let o=(0,s.createApi)({reducerPath:"permissionsApi",baseQuery:(0,s.fetchBaseQuery)({baseUrl:"http://3.86.194.103/api/v1/"}),refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,endpoints:e=>({getPermissions:e.query({query:()=>({url:"permiso",method:"GET"})})})}),{useGetPermissionsQuery:n}=o},96407:function(e,r,t){"use strict";t.d(r,{Lh:function(){return l},Ym:function(){return n},gK:function(){return a},h0:function(){return o},rz:function(){return i}});var s=t(32895);let o=(0,s.createApi)({reducerPath:"rolesApi",baseQuery:(0,s.fetchBaseQuery)({baseUrl:"http://3.86.194.103/api/v1/"}),refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,tagTypes:["roles"],endpoints:e=>({getRoles:e.query({query:()=>({url:"rol",method:"GET"}),providesTags:["roles"]}),createRole:e.mutation({query:e=>({url:"rol",method:"POST",body:e}),invalidatesTags:["roles"]}),updateRole:e.mutation({query:e=>{let{role:r,id:t}=e;return{url:"rol/".concat(t),method:"PUT",body:r}},invalidatesTags:["roles"]}),deleteRole:e.mutation({query:e=>({url:"rol/".concat(e),method:"DELETE"}),invalidatesTags:["roles"]})})}),{useGetRolesQuery:n,useCreateRoleMutation:l,useUpdateRoleMutation:a,useDeleteRoleMutation:i}=o},66625:function(e,r,t){"use strict";var s=t(86006),o=t(99329),n=function(){return(n=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},l=s.forwardRef(function(e,r){var t=n(n({},s.useContext(o.s)),e);return s.createElement("svg",n({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:r},t),s.createElement("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))});r.Z=l},39558:function(e,r,t){"use strict";var s=t(86006),o=t(99329),n=function(){return(n=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},l=s.forwardRef(function(e,r){var t=n(n({},s.useContext(o.s)),e);return s.createElement("svg",n({width:"1.5em",height:"1.5em",strokeWidth:1.5,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:r},t),s.createElement("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))});r.Z=l}},function(e){e.O(0,[8779,4790,8945,2641,803,4389,545,4176,4059,2229,3750,1452,1728,3206,4425,638,5243,3933,9833,2005,2724,8288,4294,2667,8139,1744],function(){return e(e.s=47685)}),_N_E=e.O()}]);
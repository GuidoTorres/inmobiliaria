(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9757],{68934:function(e,r,t){Promise.resolve().then(t.bind(t,70131))},70131:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return I}});var a=t(9268),l=t(90362),n=t(98945),s=t(92951),o=t(53195),i=t(83206),d=t(70509),c=t(76234),u=t(53235),m=t(80970),p=t(50946),h=t(47434),x=t(5710),g=t(86006),f=t(99329),j=function(){return(j=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var l in r=arguments[t])Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l]);return e}).apply(this,arguments)},v=g.forwardRef(function(e,r){var t=j(j({},g.useContext(f.s)),e);return g.createElement("svg",j({width:"1.5em",height:"1.5em",viewBox:"0 0 24 24",strokeWidth:1.5,fill:"none",xmlns:"http://www.w3.org/2000/svg",color:"currentColor",ref:r},t),g.createElement("path",{d:"M9 12h3m3 0h-3m0 0V9m0 3v3M4 21.4V2.6a.6.6 0 01.6-.6h11.652a.6.6 0 01.424.176l3.148 3.148A.6.6 0 0120 5.75V21.4a.6.6 0 01-.6.6H4.6a.6.6 0 01-.6-.6z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),g.createElement("path",{d:"M16 2v3.4a.6.6 0 00.6.6H20",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}))}),b=t(4660),w=t(52641),y=t(68232),Z=t(68919);let{Dragger:N}=o.Z,C=e=>{let{handleCancel:r}=e,t=(0,b.I)(),l=(0,w.useSelector)(e=>e.crud.data),[n]=i.Z.useForm(),[o,f]=(0,g.useState)(x.B2),[j,C]=(0,g.useState)([]);(0,g.useEffect)(()=>{l&&(f(l),n.setFieldsValue(l),""===l.titulo_propiedad?C([]):C([{uid:"-1",name:"titulo_propiedad.pdf",status:"done",url:l.titulo_propiedad}]))},[l]);let E=(e,r)=>{if(!r&&e.target){let{name:r,value:t}=e.target;n.setFieldsValue({[r]:t||""}),f(e=>({...e,[r]:t||""}))}else n.setFieldsValue({[r]:e||""}),f(t=>({...t,[r]:e||""}))},k=e=>{let r=[...e.fileList];C(r=(r=r.slice(-2)).map(e=>(e.response&&(e.url=e.response.url),e)))};(0,g.useEffect)(()=>{0===j.length?n.setFieldsValue({file:null}):n.setFieldsValue({file:"archivo"})},[j]);let[L,{isLoading:O,error:F,isError:q,isSuccess:P,data:T}]=(0,y.Zw)(),[I,{isLoading:_,error:D,isError:S,isSuccess:V,data:M}]=(0,y.sN)(),A=async e=>{var r,t;let a=new FormData;a.append("nombre",e.nombre||""),a.append("dni",e.dni||""),a.append("celular",e.celular||""),a.append("direccion",e.direccion||""),a.append("titulo_propiedad",(null===(r=j[0])||void 0===r?void 0:r.originFileObj)||(null===(t=j[0])||void 0===t?void 0:t.url)||"");try{l?await I({owner:a,id:o.cod_propietario}):await L(a)}catch(e){Z.toast.error(e)}};return(0,g.useEffect)(()=>{var e,t;q&&Z.toast.error(null===(e=F.data)||void 0===e?void 0:e.msg),S&&Z.toast.error(null===(t=D.data)||void 0===t?void 0:t.msg),P&&(Z.toast.success(null==T?void 0:T.msg),r()),V&&(Z.toast.success(null==M?void 0:M.msg),r())},[q,P,S,V]),(0,a.jsxs)(i.Z,{form:n,layout:"vertical",requiredMark:!0,onFinish:A,autoComplete:"off",scrollToFirstError:!0,children:[(0,a.jsxs)(d.Z,{gutter:[16,16],children:[(0,a.jsx)(c.Z,{xs:24,md:12,lg:16,children:(0,a.jsx)(i.Z.Item,{name:"nombre",label:(0,a.jsx)(h.L,{text:"Propietario:"}),hasFeedback:!0,rules:[{required:!0,message:"Ingrese el nombre del propietario"}],children:(0,a.jsx)(u.Z,{name:"nombre",value:o.nombre,onChange:E,placeholder:"Ingrese el nombre del propietario",allowClear:!0})})}),(0,a.jsx)(c.Z,{xs:24,md:12,lg:8,children:(0,a.jsx)(i.Z.Item,{name:"dni",label:(0,a.jsx)(h.L,{text:"N\xb0 de DNI"}),rules:[{required:!0,message:"Ingrese un n\xfamero de DNI."},{validator:(e,r)=>r&&8!==r.toString().length?Promise.reject(Error("El campo debe tener 8 d\xedgitos")):Promise.resolve()}],hasFeedback:!0,children:(0,a.jsx)(m.Z,{name:"dni",maxLength:8,value:o.dni,placeholder:"N\xfamero de dni",className:"w-full",onChange:e=>E(e,"dni")})})}),(0,a.jsx)(c.Z,{xs:24,md:12,lg:16,children:(0,a.jsx)(i.Z.Item,{name:"direccion",label:(0,a.jsx)(h.L,{text:"Direcci\xf3n"}),rules:[{required:!0,message:"Ingrese una direcci\xf3n."}],hasFeedback:!0,children:(0,a.jsx)(u.Z,{name:"direccion",value:o.direccion,placeholder:"Direcci\xf3n",onChange:E,allowClear:!0})})}),(0,a.jsx)(c.Z,{xs:24,md:12,lg:8,children:(0,a.jsx)(i.Z.Item,{name:"celular",label:(0,a.jsx)(h.L,{text:"N\xb0 de celular"}),rules:[{required:!0,message:"Ingrese su nro de celular"}],hasFeedback:!0,children:(0,a.jsx)(u.Z,{name:"celular",value:o.celular,placeholder:"N\xb0 celular",onChange:E,allowClear:!0})})})]}),(0,a.jsx)(s.Z,{}),(0,a.jsx)(i.Z.Item,{name:"file",value:j,label:(0,a.jsx)(h.L,{text:"Agregar titulo de propiedad"}),rules:[{required:!0,message:"Debe subir el titulo de propiedad."}],children:(0,a.jsxs)(N,{name:"file",maxCount:1,multiple:!1,fileList:j||[],onChange:k,beforeUpload:e=>!1,children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon flex justify-center",children:(0,a.jsx)(v,{width:30,height:30})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"Haga clic o arrastre el archivo a esta \xe1rea para cargar"}),(0,a.jsx)("p",{className:"ant-upload-hint",children:"Soporte para una carga \xfanica"})]})}),(0,a.jsx)(i.Z.Item,{children:(0,a.jsxs)(d.Z,{gutter:[16,16],justify:"end",children:[(0,a.jsx)(c.Z,{xs:24,md:12,lg:4,justify:"end",order:t?2:1,children:(0,a.jsx)(p.ZP,{onClick:r,className:"w-full",children:"Cancelar"},"back")}),(0,a.jsx)(c.Z,{xs:24,md:12,lg:6,order:t?1:2,children:(0,a.jsx)(p.ZP,{type:"primary",loading:l?_:O,htmlType:"submit",className:"w-full",children:"Guardar propietario"})})]})})]})};var E=t(96230);let k=e=>{let{isModalOpen:r,handleCancel:t}=e,o=(0,w.useDispatch)(),i=(0,w.useSelector)(e=>e.crud.data),d=()=>{t(),o((0,E.qD)())};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(l.Z,{title:(0,a.jsx)(n.Z.Title,{level:3,className:"text-center text-text-title",children:i?"Editar Propietario":"Nuevo Propietario"}),style:{top:20},width:1e3,open:r,onCancel:d,footer:null,children:[(0,a.jsx)(s.Z,{className:"mt-0"}),(0,a.jsx)(C,{handleCancel:d})]})})};var L=t(91608);let O=e=>{let{loading:r,columns:t,data:l}=e;return(0,a.jsx)(L.Z,{loading:r,columns:t,dataSource:l,rowKey:e=>e.cod_propietario,scroll:{x:"max-content",y:"max-content"}})};var F=t(24294),q=t(88334),P=t(15834),T=t(8540);function I(){let e=(0,w.useDispatch)(),[r,{isError:t,isSuccess:l,error:n,data:o}]=(0,y.V7)(),[i,{isLoading:u}]=(0,y.NN)(),m=r=>{e((0,E.qT)({data:r})),f()},h=async e=>{try{await r(e)}catch(e){Z.toast.error(e)}};(0,g.useEffect)(()=>{if(t){var e;Z.toast.error(null===(e=n.data)||void 0===e?void 0:e.msg)}l&&Z.toast.success(null==o?void 0:o.msg)},[t,l]);let{isModalOpen:x,handleOpen:f,handleCancel:j}=(0,q.d)(),v=(0,F.km)(m,h),{isLoading:b,data:N,error:C,isError:L}=(0,y.Lc)(null),I=(0,g.useMemo)(()=>null==N?void 0:N.data,[N]);(0,g.useEffect)(()=>{var e;L&&Z.toast.error(null===(e=C.data)||void 0===e?void 0:e.msg)},[C]);let _=async()=>{try{await i()}catch(e){Z.toast.error(e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(P.Z,{direction:"vertical",className:"w-full",size:"large",children:[(0,a.jsx)(d.Z,{gutter:[16,16],align:"middle",justify:"end",children:(0,a.jsx)(c.Z,{xs:24,md:24,lg:12,children:(0,a.jsxs)(d.Z,{gutter:[16,16],justify:"end",children:[(0,a.jsx)(c.Z,{xs:24,md:12,lg:10,children:(0,a.jsx)(p.ZP,{type:"primary",onClick:f,className:"w-full",children:"Nuevo propietario"})}),(0,a.jsx)(c.Z,{xs:24,md:12,lg:8,children:(0,a.jsx)(p.ZP,{icon:(0,a.jsx)(T.Z,{}),className:"flex justify-center items-center w-full",type:"primary",loading:u,onClick:_,children:"Exportar"})})]})})}),(0,a.jsx)(s.Z,{className:"m-0"}),(0,a.jsx)("div",{children:(0,a.jsx)(O,{loading:b,columns:v,data:I})})]}),x&&(0,a.jsx)(k,{isModalOpen:x,handleCancel:j})]})}},68232:function(e,r,t){"use strict";t.d(r,{Lc:function(){return o},NN:function(){return u},V7:function(){return c},Zw:function(){return i},jm:function(){return s},sN:function(){return d}});var a=t(32895),l=t(86902),n=t.n(l);let s=(0,a.createApi)({reducerPath:"ownersApi",baseQuery:(0,a.fetchBaseQuery)({baseUrl:"http://3.86.194.103/api/v1/"}),refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,tagTypes:["owners"],endpoints:e=>({getOwners:e.query({query:()=>({url:"propietario",method:"GET"}),providesTags:["owners"]}),createOwner:e.mutation({query:e=>({url:"propietario",method:"POST",body:e}),invalidatesTags:["owners"]}),updateOwner:e.mutation({query:e=>{let{owner:r,id:t}=e;return{url:"propietario/".concat(t),method:"PUT",body:r}},invalidatesTags:["owners"]}),deleteOwner:e.mutation({query:e=>({url:"propietario/".concat(e),method:"DELETE"}),invalidatesTags:["owners"]}),downloadOwners:e.query({query:()=>({url:"propietario/descargar",method:"GET",responseType:"blob",responseHandler:async e=>{let r=await e.blob(),t=URL.createObjectURL(r),a=document.createElement("a");a.href=t,a.setAttribute("download","Propietarios_".concat(n()().format("YYYY-MM-DD-HH-mm-ss"),".xlsx")),a.setAttribute("target","_blank"),document.body.appendChild(a),a.click()},cache:"no-cache"})})})}),{useGetOwnersQuery:o,useCreateOwnerMutation:i,useUpdateOwnerMutation:d,useDeleteOwnerMutation:c,useLazyDownloadOwnersQuery:u}=s}},function(e){e.O(0,[8779,4790,8945,2641,803,4389,545,4176,4059,2229,3750,1452,1728,3206,4425,638,5243,3933,9833,2005,3195,4294,2667,8139,1744],function(){return e(e.s=68934)}),_N_E=e.O()}]);